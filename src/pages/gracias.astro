---
import { Image } from 'astro:assets';
import covaroLogo from '../assets/covaro.jpg';
---

<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>Gracias por Registrarte</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Meta Pixel Code -->
    <script>
      !function(f,b,e,v,n,t,s)
      {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
      n.callMethod.apply(n,arguments):n.queue.push(arguments)};
      if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
      n.queue=[];t=b.createElement(e);t.async=!0;
      t.src=v;s=b.getElementsByTagName(e)[0];
      s.parentNode.insertBefore(t,s)}(window, document,'script',
      'https://connect.facebook.net/en_US/fbevents.js');
      fbq('init', '1054543913267868');
      fbq('track', 'PageView');
      fbq('track', 'CompleteRegistration'); <!-- ✅ Solo una vez -->
    </script>
    <noscript>
      <img height="1" width="1" style="display:none"
           src="https://www.facebook.com/tr?id=1054543913267868&ev=CompleteRegistration&noscript=1"/>
    </noscript>

    <style>
      /* tu estilo permanece igual */
    </style>
  </head>
  <body>
    <div class="timer">
      <div>
        <span id="seconds">05</span>
        <small>Segundos</small>
      </div>
    </div>

    <img src="/ruta/covaro.jpg" alt="Logo Covaro" height="70" class="logo" />

    <h2>¡IMPORTANTE! Únete al grupo ahora!</h2>
    <h3>Allí te mandaremos todos los detalles del zoom</h3>

    <a href="https://chat.whatsapp.com/GCozvVkGq5qHAj3Z8QyWUp" class="whatsapp-button" id="whatsappBtn" target="_blank">
      UNIRME AL GRUPO DE WHATSAPP AQUÍ
    </a>

    <script>
      const whatsappLink = "https://chat.whatsapp.com/GCozvVkGq5qHAj3Z8QyWUp";
      let seconds = 5;
      const secondsElement = document.getElementById('seconds');
      const whatsappBtn = document.getElementById('whatsappBtn');

      function redirectToWhatsApp() {
        window.location.href = whatsappLink;
        setTimeout(() => {
          window.open(whatsappLink, '_blank');
        }, 1000);
      }

      const interval = setInterval(() => {
        seconds--;
        secondsElement.textContent = String(seconds).padStart(2, '0');

        if (seconds <= 0) {
          clearInterval(interval);
          redirectToWhatsApp();
        }
      }, 1000);
    </script>
  </body>
</html>
